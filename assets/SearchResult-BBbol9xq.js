import{e as N,u as X,f as $,g as Z,j as ee,t as se,h as te,i as k,k as g,l as t,m as le,w as ae,n as ie,R as J,p as re,q as ue,v as Ee,x as oe,y as ne,z as Q,A as M,D as Ae,B as ce,C as me,E as he,F as ve,G as pe,H as de,I as ye,J as T,K as Ce,L as D}from"./app-DyxRlPgD.js";const Be=["/","/posts/","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/1.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/2.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/3.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/4.5.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/4.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/5.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/6.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/7.html","/posts/C-%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/CRLF_and_LF.html","/posts/C-%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/ConsoleRunner.html","/posts/C-%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/random.html","/posts/C-%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/time_and_space.html","/posts/C-%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/xmake.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/0.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/1.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/2.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/3.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/4.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/5.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/6-ex.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/6.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/7.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/8-ex-linkedlist.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/8-ex-vector.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/8.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/challenges.html","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/pointer.html","/404.html","/posts/C__-SFML-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/","/posts/C-%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/","/posts/DotOJ-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/","/category/","/category/c__-sfml/","/category/c-%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/","/category/cpl-dotoj-%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/","/tag/","/tag/c__/","/tag/sfml/","/tag/cpl/","/tag/dotoj/","/article/","/star/","/timeline/"],Fe="SLIMSEARCH_QUERY_HISTORY",p=T(Fe,[]),ge=()=>{const{queryHistoryCount:a}=D;return{enabled:a>0,queryHistories:p,addQueryHistory:u=>{p.value=Array.from(new Set([u,...p.value.slice(0,a-1)]))},removeQueryHistory:u=>{p.value=[...p.value.slice(0,u),...p.value.slice(u+1)]}}},x=a=>Be[a.id]+("anchor"in a?`#${a.anchor}`:""),De="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:I}=D,d=T(De,[]),_e=()=>({enabled:I>0,resultHistories:d,addResultHistory:r=>{{const u={link:x(r),display:r.display};"header"in r&&(u.header=r.header),d.value=[u,...d.value.slice(0,I-1)]}},removeResultHistory:r=>{d.value=[...d.value.slice(0,r),...d.value.slice(r+1)]}}),fe=a=>{const r=Ae(),u=$(),_=ce(),E=k(0),y=g(()=>E.value>0),A=me([]);return he(()=>{const{search:f,terminate:m}=ve(),C=de(h=>{const{resultsFilter:H=l=>l,querySplitter:v,suggestionsFilter:O,...i}=r.value;h?(E.value+=1,f(h,u.value,i).then(l=>H(l,h,u.value,_.value)).then(l=>{E.value-=1,A.value=l}).catch(l=>{console.warn(l),E.value-=1,E.value||(A.value=[])})):A.value=[]},D.searchDelay-D.suggestDelay,{maxWait:5e3});pe([a,u],([h])=>C(h.join(" "))),ye(()=>{m()})}),{isSearching:y,results:A}};var Se=N({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:r}){const u=X(),_=$(),E=Z(ee),{addQueryHistory:y,queryHistories:A,removeQueryHistory:f}=ge(),{resultHistories:m,addResultHistory:C,removeResultHistory:h}=_e(),H=se(a,"queries"),{results:v,isSearching:O}=fe(H),i=te({isQuery:!0,index:0}),l=k(0),c=k(0),q=g(()=>A.value.length>0||m.value.length>0),S=g(()=>v.value.length>0),L=g(()=>v.value[l.value]||null),b=()=>{const{isQuery:e,index:s}=i;s===0?(i.isQuery=!e,i.index=e?m.value.length-1:A.value.length-1):i.index=s-1},j=()=>{const{isQuery:e,index:s}=i;s===(e?A.value.length-1:m.value.length-1)?(i.isQuery=!e,i.index=0):i.index=s+1},U=()=>{l.value=l.value>0?l.value-1:v.value.length-1,c.value=L.value.contents.length-1},P=()=>{l.value=l.value<v.value.length-1?l.value+1:0,c.value=0},Y=()=>{c.value<L.value.contents.length-1?c.value+=1:P()},z=()=>{c.value>0?c.value-=1:U()},R=e=>e.map(s=>Ce(s)?s:t(s[0],s[1])),G=e=>{if(e.type==="customField"){const s=oe[e.index]||"$content",[o,F=""]=ne(s)?s[_.value].split("$content"):s.split("$content");return e.display.map(n=>t("div",R([o,...n,F])))}return e.display.map(s=>t("div",R(s)))},B=()=>{l.value=0,c.value=0,r("updateQuery",""),r("close")},K=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},E.value.queryHistory),A.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:i.isQuery&&i.index===s}],onClick:()=>{r("updateQuery",e)}},[t(Q,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:M,onClick:o=>{o.preventDefault(),o.stopPropagation(),f(s)}})]))])),V=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},E.value.resultHistory),m.value.map((e,s)=>t(J,{to:e.link,class:["slimsearch-result-item",{active:!i.isQuery&&i.index===s}],onClick:()=>{B()}},()=>[t(Q,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(o=>R(o)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:M,onClick:o=>{o.preventDefault(),o.stopPropagation(),h(s)}})]))]));return le("keydown",e=>{if(a.isFocusing){if(S.value){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const s=L.value.contents[c.value];y(a.queries.join(" ")),C(s),u.push(x(s)),B()}}else if(e.key==="ArrowUp")b();else if(e.key==="ArrowDown")j();else if(e.key==="Enter"){const{index:s}=i;i.isQuery?(r("updateQuery",A.value[s]),e.preventDefault()):(u.push(m.value[s].link),B())}}}),ae([l,c],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!S.value:!q.value}],id:"slimsearch-results"},a.queries.length?O.value?t(ie,{hint:E.value.searching}):S.value?t("ul",{class:"slimsearch-result-list"},v.value.map(({title:e,contents:s},o)=>{const F=l.value===o;return t("li",{class:["slimsearch-result-list-item",{active:F}]},[t("div",{class:"slimsearch-result-title"},e||E.value.defaultTitle),s.map((n,W)=>{const w=F&&c.value===W;return t(J,{to:x(n),class:["slimsearch-result-item",{active:w,"aria-selected":w}],onClick:()=>{y(a.queries.join(" ")),C(n),B()}},()=>[n.type==="text"?null:t(n.type==="title"?re:n.type==="heading"?ue:Ee,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[n.type==="text"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",G(n))])])})])})):E.value.emptyResult:q.value?[K(),V()]:E.value.emptyHistory)}});export{Se as default};
